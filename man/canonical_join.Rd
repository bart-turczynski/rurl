% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/canonical_join.R
\name{canonical_join}
\alias{canonical_join}
\title{Canonical Join of Two URL Sets (Base R Version)}
\usage{
canonical_join(
  data_A,
  data_B,
  col_A = "URL",
  col_B = "URL",
  suffix_A = "_A",
  suffix_B = "_B",
  join = c("inner", "left", "right", "full"),
  collision = c("first", "all", "error"),
  on_parse_error = c("keep", "drop", "error"),
  ...
)
}
\arguments{
\item{data_A}{A data frame containing URLs for the left side of the join.}

\item{data_B}{A data frame containing URLs for the right side of the join.}

\item{col_A}{Character string, the name of the column in \code{data_A} that
contains URLs. Defaults to "URL".}

\item{col_B}{Character string, the name of the column in \code{data_B} that
contains URLs. Defaults to "URL".}

\item{suffix_A}{Character string, suffix to append to \code{data_A} columns
(excluding the URL column) in the output. Defaults to "_A".}

\item{suffix_B}{Character string, suffix to append to \code{data_B} columns
(excluding the URL column) in the output. Defaults to "_B".}

\item{join}{Join type: \code{"inner"}, \code{"left"}, \code{"right"}, or
\code{"full"}. Defaults to \code{"inner"}.}

\item{collision}{How to handle duplicate canonical keys within inputs.
\code{"first"} keeps the first row per key, \code{"all"} keeps all rows
(many-to-many), and \code{"error"} stops on duplicates. Defaults to \code{"first"}.}

\item{on_parse_error}{How to handle URLs that fail canonicalization.
\code{"keep"} retains them as unmatched rows (for left/right/full joins),
\code{"drop"} removes them before joining, and \code{"error"} stops.
Defaults to \code{"keep"}.}

\item{...}{Additional arguments forwarded to \code{\link{safe_parse_urls}},
controlling canonicalization (e.g., \code{protocol_handling},
\code{www_handling}, \code{trailing_slash_handling}, \code{index_page_handling},
\code{path_normalization}, \code{scheme_relative_handling}, \code{host_encoding},
\code{path_encoding}).}
}
\value{
A data frame representing the join. The output includes:
  \itemize{
    \item The original URL columns (named after the input objects).
    \item \code{JoinKey}: the canonicalized URL used for matching.
    \item All other columns from \code{data_A} and \code{data_B} with
          suffixes applied.
  }
  Returns an empty data frame with the expected structure if no matches are found
  or if inputs are invalid.
}
\description{
Performs a join between two data frames by canonicalizing URLs to a shared
"clean" format using \code{\link{safe_parse_urls}} and then matching on that key.
This avoids permutation expansion and is suitable for large crawl exports.
}
\examples{
A <- data.frame(URL = c("http://Example.com/Page", "http://example.com/Other"),
                ValA = 1:2, stringsAsFactors = FALSE)
B <- data.frame(URL = c("https://www.example.com/Page/", "http://example.com/Miss"),
                ValB = c("x", "y"), stringsAsFactors = FALSE)

canonical_join(
  A, B,
  protocol_handling = "strip",
  www_handling = "strip",
  case_handling = "lower_host",
  trailing_slash_handling = "strip"
)
}
